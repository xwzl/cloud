# RabbitMq 感悟

ConnectionFactory 用来连接 RabbitMq 服务器， Channel 是一次会话中的重要成员，所有的操作基于此。

### 消费者、路由键、交换机、绑定键、消息队列的之间的关系

消费者通过路由键传递消息给交换机，交换机通过绑定键发送给消息给消息队列。

这里交换机的类型不同，可能对绑定键与路由键校对关系有所不同。 

- fanout：忽略绑定键，直接把所有消息分配给消息队列
- direct: 路由键与绑定键严格匹配
- topic: 路由键与绑定键按照规则匹配，* 表示匹配一个单词， # 表示匹配 >= 0 单词，其中 字符串以 . 分隔单词

### 注意点

RabbitMq 并不清楚你是否完成了业务逻辑，因此需要设置一个消息回调。当消息回调没有触发时，消息并不会被删除，而是等待消息会调。
若是出现异常或者连接断开，RabbitMq 认为你已经失败，会把消息分发给另外一个消息队列。

但是如果没有忘记回调，消息队列中堆积的信息会越来越多。

详情参考 CallBackSender 